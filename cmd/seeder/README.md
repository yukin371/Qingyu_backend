# æµ‹è¯•æ•°æ®å¡«å……å·¥å…· (Seeder)

ä¸ºé’ç¾½å†™ä½œå¹³å°å¿«é€Ÿç”Ÿæˆå¤§è§„æ¨¡æµ‹è¯•æ•°æ®çš„ç»Ÿä¸€å·¥å…·ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ é«˜æ€§èƒ½æ‰¹é‡æ•°æ®ç”Ÿæˆ
- ğŸ“Š æ”¯æŒå¤šç§æ•°æ®è§„æ¨¡ï¼ˆsmall/medium/largeï¼‰
- ğŸ”’ å®‰å…¨çš„ MongoDB æ‰¹é‡æ“ä½œ
- âœ… å†…ç½®æ•°æ®å®Œæ•´æ€§éªŒè¯
- ğŸ™ï¸ å‹å¥½çš„å‘½ä»¤è¡Œç•Œé¢
- ğŸ“š **ä¸€ç«™å¼æ•°æ®å¡«å……** - æ•´åˆäº†æ‰€æœ‰åˆ†æ•£çš„æ•°æ®å¡«å……å·¥å…·

## å®‰è£…

```bash
cd Qingyu_backend/cmd/seeder
go mod download
go build -o seeder .
```

## å‘½ä»¤åˆ—è¡¨

### æ ¸å¿ƒå‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ | ä¾èµ– |
|------|------|------|
| `all` | å¡«å……æ‰€æœ‰åŸºç¡€æ•°æ®ï¼ˆç”¨æˆ·ã€ä¹¦ç±ã€è®¢é˜…å…³ç³»ï¼‰ | - |
| `users` | åªå¡«å……ç”¨æˆ·æ•°æ® | - |
| `bookstore` | åªå¡«å……ä¹¦ç±æ•°æ®å’ŒBanner | - |
| `chapters` | å¡«å……ç« èŠ‚æ•°æ®å’Œå†…å®¹ | books |
| `social` | å¡«å……ç¤¾äº¤æ•°æ®ï¼ˆè¯„è®ºã€ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼‰ | users, books |
| `wallets` | å¡«å……é’±åŒ…å’Œäº¤æ˜“æ•°æ® | users |
| `rankings` | å¡«å……æ¦œå•æ•°æ® | books |
| `ai-quota` | æ¿€æ´»ç”¨æˆ·AIé…é¢ | users |
| `import` | ä»JSONæ–‡ä»¶å¯¼å…¥å°è¯´æ•°æ® | - |
| `clean` | æ¸…ç©ºæ‰€æœ‰æµ‹è¯•æ•°æ® | - |
| `verify` | éªŒè¯æ•°æ®å®Œæ•´æ€§ | - |
| `test` | å¡«å……E2Eæµ‹è¯•æ‰€éœ€çš„ç‰¹å®šæ•°æ® | - |

### å…¨å±€æ ‡å¿—

æ‰€æœ‰å‘½ä»¤éƒ½æ”¯æŒä»¥ä¸‹å…¨å±€æ ‡å¿—ï¼š

| æ ‡å¿— | ç®€å†™ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| --scale | -s | æ•°æ®è§„æ¨¡ (small/medium/large) | medium |
| --clean | -c | å¡«å……å‰æ¸…ç©ºç°æœ‰æ•°æ® | false |

## ä½¿ç”¨æ–¹æ³•

### æŸ¥çœ‹å¸®åŠ©

```bash
./seeder --help
./seeder all --help
```

### ä¸€é”®åˆå§‹åŒ–å®Œæ•´æµ‹è¯•ç¯å¢ƒ

```bash
# å¡«å……æ‰€æœ‰åŸºç¡€æ•°æ®
./seeder all --scale medium

# ç„¶åå¡«å……æ‰©å±•æ•°æ®
./seeder chapters
./seeder social
./seeder wallets
./seeder rankings
./seeder ai-quota
```

### å¡«å……ç‰¹å®šæ¨¡å—

```bash
# åªå¡«å……ç”¨æˆ·
./seeder users -s medium

# åªå¡«å……ä¹¦ç±
./seeder bookstore -s large

# å¡«å……ç« èŠ‚æ•°æ®ï¼ˆéœ€è¦å…ˆæœ‰ä¹¦ç±ï¼‰
./seeder chapters

# å¡«å……ç¤¾äº¤æ•°æ®ï¼ˆéœ€è¦å…ˆæœ‰ç”¨æˆ·å’Œä¹¦ç±ï¼‰
./seeder social

# å¡«å……é’±åŒ…æ•°æ®ï¼ˆéœ€è¦å…ˆæœ‰ç”¨æˆ·ï¼‰
./seeder wallets

# å¡«å……æ¦œå•æ•°æ®ï¼ˆéœ€è¦å…ˆæœ‰ä¹¦ç±ï¼‰
./seeder rankings

# æ¿€æ´»AIé…é¢ï¼ˆéœ€è¦å…ˆæœ‰ç”¨æˆ·ï¼‰
./seeder ai-quota
```

### å¯¼å…¥å°è¯´æ•°æ®

```bash
# ä»JSONæ–‡ä»¶å¯¼å…¥100æœ¬å°è¯´
./seeder import

# è‡ªå®šä¹‰æ–‡ä»¶è·¯å¾„
./seeder import --file data/novels_100.json
```

### æ¸…ç©ºæ•°æ®

```bash
# æ¸…ç©ºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼ˆéœ€è¦è¾“å…¥ YES ç¡®è®¤ï¼‰
./seeder clean
```

### éªŒè¯æ•°æ®

```bash
./seeder verify
```

## æ•°æ®è§„æ¨¡

| è§„æ¨¡   | ç”¨æˆ·æ•° | ä¹¦ç±æ•° | ä½œè€…æ•° |
| ------ | ------ | ------ | ------ |
| small  | 50     | 100    | 20     |
| medium | 500    | 500    | 100    |
| large  | 2000   | 1200   | 400    |

## ç”Ÿæˆçš„æ•°æ®

### ç”¨æˆ·æ•°æ® (users)
- çœŸå®æµ‹è¯•è´¦å·ï¼ˆadmin, author1, reader1, vip_userï¼‰
- æ™®é€šç”¨æˆ·ã€ä½œè€…ã€VIP ç”¨æˆ·
- éšæœºç”¨æˆ·åã€é‚®ç®±ã€å¤´åƒ

### ä¹¦ç±æ•°æ® (bookstore)
- **åˆ†ç±»æ¯”ä¾‹**ï¼š
  - ä»™ä¾ : 30%
  - éƒ½å¸‚: 25%
  - ç§‘å¹»: 20%
  - å†å²: 15%
  - å…¶ä»–: 10%
- **çƒ­åº¦ç­‰çº§**ï¼š
  - é«˜çƒ­åº¦ï¼šè¯„åˆ† 8.5-9.5ï¼Œ200-500 è®¢é˜…
  - ä¸­çƒ­åº¦ï¼šè¯„åˆ† 6.0-8.5ï¼Œ20-200 è®¢é˜…
  - ä½çƒ­åº¦ï¼šè¯„åˆ† 4.0-6.0ï¼Œ0-20 è®¢é˜…
- **Banner æ•°æ®**: 2ä¸ªè½®æ’­å›¾

### ç« èŠ‚æ•°æ® (chapters)
- ä¸ºæ¯æœ¬ä¹¦ç”Ÿæˆ 30-500 ç« ï¼ˆæ ¹æ®ä¹¦ç±çŠ¶æ€ï¼‰
- æ¯ç«  1000-2000 å­—
- å‰10ç« å…è´¹
- ç« èŠ‚å†…å®¹è‡ªåŠ¨ç”Ÿæˆ

### ç¤¾äº¤æ•°æ® (social)
- **è¯„è®º**: æ¯æœ¬ä¹¦ 5-20 æ¡è¯„è®º
- **ç‚¹èµ**: æ¯æœ¬ä¹¦ 10-100 ä¸ªç‚¹èµ
- **æ”¶è—**: æ¯ä¸ªç”¨æˆ· 5-30 ä¸ªæ”¶è—
- **å…³æ³¨**: æ¯ä¸ªç”¨æˆ· 5-50 ä¸ªå…³æ³¨

### é’±åŒ…æ•°æ® (wallets)
- ç®¡ç†å‘˜ï¼š10000 åˆå§‹ä½™é¢
- VIPç”¨æˆ·ï¼š5000-10000 åˆå§‹ä½™é¢
- ä½œè€…ï¼š3000-6000 åˆå§‹ä½™é¢
- æ™®é€šç”¨æˆ·ï¼š100-1000 åˆå§‹ä½™é¢
- è‡ªåŠ¨ç”Ÿæˆå……å€¼å’Œæ¶ˆè´¹è®°å½•

### æ¦œå•æ•°æ® (rankings)
- å®æ—¶æ¦œã€æ—¥æ¦œã€å‘¨æ¦œã€æœˆæ¦œ
- æ–°äººæ¦œã€å®Œç»“æ¦œ
- æ ¹æ®ä¹¦ç±è¯„åˆ†å’Œæµè§ˆé‡æ’åº

### AIé…é¢ (ai-quota)
- ç®¡ç†å‘˜ï¼š999999ï¼ˆæ— é™é…é¢ï¼‰
- VIPç”¨æˆ·ï¼š100000
- æ™®é€šç”¨æˆ·ï¼š10000

## é…ç½®

é»˜è®¤é…ç½®ï¼š
- MongoDB URI: `mongodb://localhost:27017`
- Database: `qingyu`
- Batch Size: 100

å¯é€šè¿‡ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶ä¿®æ”¹ï¼ˆå¾…å®ç°ï¼‰ã€‚

## é¡¹ç›®ç»“æ„

```
cmd/seeder/
â”œâ”€â”€ main.go                  # ä¸»ç¨‹åºå’Œ CLI
â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†
â”œâ”€â”€ generators/              # æ•°æ®ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ base.go             # åŸºç¡€ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ user.go             # ç”¨æˆ·ç”Ÿæˆå™¨
â”‚   â””â”€â”€ book.go             # ä¹¦ç±ç”Ÿæˆå™¨
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ mongodb.go          # MongoDB æ“ä½œ
â”‚   â””â”€â”€ verify.go           # æ•°æ®éªŒè¯
â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ user.go
â”‚   â””â”€â”€ book.go
â”œâ”€â”€ seeder_*.go              # æ•°æ®å¡«å……å™¨
â”‚   â”œâ”€â”€ seeder_users.go
â”‚   â”œâ”€â”€ seeder_bookstore.go
â”‚   â”œâ”€â”€ seeder_chapters.go
â”‚   â”œâ”€â”€ seeder_social.go
â”‚   â”œâ”€â”€ seeder_wallets.go
â”‚   â”œâ”€â”€ seeder_rankings.go
â”‚   â”œâ”€â”€ seeder_ai_quota.go
â”‚   â””â”€â”€ seeder_import.go
â””â”€â”€ README.md
```

## æŠ€æœ¯æ ˆ

- Go 1.22+
- MongoDB 4.4+
- gofakeit v7 - æ•°æ®ç”Ÿæˆ
- Cobra v1.8 - CLI æ¡†æ¶

## å¸¸è§é—®é¢˜

### MongoDB è¿æ¥å¤±è´¥

ç¡®ä¿ MongoDB æœåŠ¡æ­£åœ¨è¿è¡Œï¼š
```bash
# Windows
net start MongoDB

# Linux/Mac
brew services start mongodb  # Mac
sudo systemctl start mongod  # Linux
```

### å‘½ä»¤ä¾èµ–å…³ç³»

æŸäº›å‘½ä»¤éœ€è¦å…ˆè¿è¡Œå…¶ä»–å‘½ä»¤ï¼š
- `chapters` éœ€è¦å…ˆè¿è¡Œ `bookstore`
- `social` éœ€è¦å…ˆè¿è¡Œ `users` å’Œ `bookstore`
- `wallets` éœ€è¦å…ˆè¿è¡Œ `users`
- `rankings` éœ€è¦å…ˆè¿è¡Œ `bookstore`
- `ai-quota` éœ€è¦å…ˆè¿è¡Œ `users`

## å®Œæ•´åˆå§‹åŒ–æµç¨‹

```bash
# 1. ç¼–è¯‘å·¥å…·
cd Qingyu_backend/cmd/seeder
go build -o seeder .

# 2. å¡«å……æ‰€æœ‰åŸºç¡€æ•°æ®
./seeder all --scale medium --clean

# 3. å¡«å……æ‰©å±•æ•°æ®
./seeder chapters
./seeder social
./seeder wallets
./seeder rankings
./seeder ai-quota

# 4. éªŒè¯æ•°æ®
./seeder verify
```

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License
