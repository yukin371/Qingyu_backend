# Phase3 gRPCå®¢æˆ·ç«¯æµ‹è¯•å·¥å…·

è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•Phase3 AIæœåŠ¡gRPCè¿æ¥çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

## ğŸ“‹ å‰ææ¡ä»¶

1. **Python AIæœåŠ¡å·²å¯åŠ¨**

```bash
cd python_ai_service
$env:GOOGLE_API_KEY="your_api_key"
python run_grpc_server.py
```

2. **Goä¾èµ–å·²å®‰è£…**

```bash
go mod tidy
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼1: æµ‹è¯•å•ä¸ªAgentï¼ˆå¿«é€Ÿï¼‰

```bash
# ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
go run cmd/test_phase3_grpc/main.go -task "åˆ›ä½œä¸€ä¸ªä¿®ä»™å°è¯´å¤§çº²"
```

**é¢„æœŸè¾“å‡º**:
```
========================================
Phase3 gRPCå®¢æˆ·ç«¯æµ‹è¯•
========================================

è¿æ¥åˆ°gRPCæœåŠ¡å™¨: localhost:50051
âœ… è¿æ¥æˆåŠŸ

1ï¸âƒ£  å¥åº·æ£€æŸ¥...
   çŠ¶æ€: healthy
   ç»„ä»¶çŠ¶æ€:
     - outline_agent: healthy
     - character_agent: healthy
     - plot_agent: healthy

2ï¸âƒ£  ç”Ÿæˆå¤§çº²...
   ä»»åŠ¡: åˆ›ä½œä¸€ä¸ªä¿®ä»™å°è¯´å¤§çº²
   âœ… æˆåŠŸ! è€—æ—¶: 9.8ç§’
   ğŸ“– æ ‡é¢˜: å¤©å‘½ä¹‹å­
   ğŸ­ ç±»å‹: ä¿®ä»™
   ğŸ“š ç« èŠ‚æ•°: 5
   ...
```

### æ–¹å¼2: æµ‹è¯•å®Œæ•´å·¥ä½œæµï¼ˆæ…¢ï¼Œ30-60ç§’ï¼‰

```bash
go run cmd/test_phase3_grpc/main.go -workflow -task "åˆ›ä½œéƒ½å¸‚çˆ±æƒ…å°è¯´è®¾å®š"
```

### æ–¹å¼3: è‡ªå®šä¹‰æœåŠ¡å™¨åœ°å€

```bash
go run cmd/test_phase3_grpc/main.go -addr "192.168.1.100:50051" -task "ä½ çš„ä»»åŠ¡"
```

## ğŸ§ª è¿è¡ŒGoå•å…ƒæµ‹è¯•

```bash
# æµ‹è¯•å®¢æˆ·ç«¯è¿æ¥
go test ./service/ai -run TestPhase3Client_HealthCheck -v

# æµ‹è¯•å¤§çº²ç”Ÿæˆ
go test ./service/ai -run TestPhase3Client_GenerateOutline -v

# æµ‹è¯•å®Œæ•´å·¥ä½œæµï¼ˆé•¿æµ‹è¯•ï¼Œè·³è¿‡ï¼‰
go test ./service/ai -run TestPhase3Client_ExecuteCreativeWorkflow -v

# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆè·³è¿‡é•¿æµ‹è¯•ï¼‰
go test ./service/ai -short -v

# æ€§èƒ½æµ‹è¯•
go test ./service/ai -bench=. -benchmem
```

## ğŸ“Š å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|--------|------|
| `-addr` | `localhost:50051` | gRPCæœåŠ¡å™¨åœ°å€ |
| `-task` | `"åˆ›ä½œä¸€ä¸ªä¿®ä»™å°è¯´å¤§çº²..."` | åˆ›ä½œä»»åŠ¡æè¿° |
| `-workflow` | `false` | æ˜¯å¦æ‰§è¡Œå®Œæ•´å·¥ä½œæµ |

## ğŸ¯ æµ‹è¯•åœºæ™¯

### åœºæ™¯1: å¥åº·æ£€æŸ¥

```bash
# ç¼–è¯‘å¹¶è¿è¡Œ
go build -o test_phase3_grpc.exe cmd/test_phase3_grpc/main.go
./test_phase3_grpc.exe
```

### åœºæ™¯2: å¤§çº²ç”Ÿæˆ

```bash
go run cmd/test_phase3_grpc/main.go \
  -task "åˆ›ä½œä¸€ä¸ªç§‘å¹»å°è¯´å¤§çº²ï¼Œä¸»è§’æ˜¯æ˜Ÿé™…æ¢é™©å®¶ï¼Œ5ç« "
```

### åœºæ™¯3: å®Œæ•´å·¥ä½œæµ

```bash
go run cmd/test_phase3_grpc/main.go \
  -workflow \
  -task "åˆ›ä½œä¸€ä¸ªæ‚¬ç–‘æ¨ç†å°è¯´çš„å®Œæ•´è®¾å®šï¼Œ3ç« "
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: è¿æ¥å¤±è´¥

```
âŒ è¿æ¥å¤±è´¥: context deadline exceeded
```

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥Python AIæœåŠ¡æ˜¯å¦å¯åŠ¨
2. æ£€æŸ¥ç«¯å£50051æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### é—®é¢˜2: å¥åº·æ£€æŸ¥å¤±è´¥

```
âŒ å¥åº·æ£€æŸ¥å¤±è´¥: rpc error
```

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤APIå¯†é’¥å·²è®¾ç½®
2. æŸ¥çœ‹PythonæœåŠ¡æ—¥å¿—
3. é‡å¯PythonæœåŠ¡

### é—®é¢˜3: è¶…æ—¶é”™è¯¯

```
âŒ å¤§çº²ç”Ÿæˆå¤±è´¥: context deadline exceeded
```

**è§£å†³æ–¹æ¡ˆ**:
1. å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆä¿®æ”¹`phase3_client.go`ï¼‰
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹PythonæœåŠ¡æ—¥å¿—

## ğŸ“ ç¤ºä¾‹è¾“å‡º

### å•Agentæµ‹è¯•è¾“å‡º

```
========================================
Phase3 gRPCå®¢æˆ·ç«¯æµ‹è¯•
========================================

è¿æ¥åˆ°gRPCæœåŠ¡å™¨: localhost:50051
âœ… è¿æ¥æˆåŠŸ

1ï¸âƒ£  å¥åº·æ£€æŸ¥...
   çŠ¶æ€: healthy

2ï¸âƒ£  ç”Ÿæˆå¤§çº²...
   âœ… æˆåŠŸ! è€—æ—¶: 9.80ç§’
   ğŸ“– æ ‡é¢˜: å¤©å‘½ä¹‹å­
   ğŸ“š ç« èŠ‚æ•°: 5

3ï¸âƒ£  ç”Ÿæˆè§’è‰²...
   âœ… æˆåŠŸ! è€—æ—¶: 12.30ç§’
   ğŸ‘¥ è§’è‰²æ•°: 3

4ï¸âƒ£  ç”Ÿæˆæƒ…èŠ‚...
   âœ… æˆåŠŸ! è€—æ—¶: 14.70ç§’
   ğŸ“… äº‹ä»¶æ•°: 18

========================================
âœ… æµ‹è¯•å®Œæˆ
========================================
```

### å®Œæ•´å·¥ä½œæµè¾“å‡º

```
ğŸ¨ æ‰§è¡Œå®Œæ•´åˆ›ä½œå·¥ä½œæµ...
   â³ è¿™å¯èƒ½éœ€è¦30-60ç§’...

============================================================
âœ… å·¥ä½œæµæ‰§è¡ŒæˆåŠŸ!
============================================================
ğŸ†” æ‰§è¡ŒID: uuid-xxx
âœ“  å®¡æ ¸çŠ¶æ€: true
ğŸ”„ åæ€æ¬¡æ•°: 0
â±ï¸  æ€»è€—æ—¶: 38.50ç§’

ğŸ“– å¤§çº²:
   æ ‡é¢˜: å¿ƒåŠ¨çš„ä¿¡å·
   ç« èŠ‚æ•°: 3

ğŸ‘¥ è§’è‰²:
   è§’è‰²æ•°: 2

ğŸ“Š æƒ…èŠ‚:
   äº‹ä»¶æ•°: 15

â±ï¸  æ‰§è¡Œæ—¶é—´åˆ†æ:
   outline: 9.80ç§’
   character: 12.30ç§’
   plot: 14.70ç§’
   æ€»è®¡: 36.80ç§’
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Phase3 gRPCé›†æˆæŒ‡å—](../../python_ai_service/GRPC_INTEGRATION_GUIDE.md)
- [Phase3å®ŒæˆæŠ¥å‘Š](../../doc/implementation/00è¿›åº¦æŒ‡å¯¼/Phase3_gRPCé›†æˆå®ŒæˆæŠ¥å‘Š_2025-10-30.md)
- [APIæ–‡æ¡£](../../python_ai_service/PHASE3_GRPC_README.md)

