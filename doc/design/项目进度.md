# 青羽轻量级阅读写作平台项目进度报告

##  项目概述

**项目名称**: 青羽轻量级阅读写作平台（Qingyu Platform）  
**技术栈**: Go + Gin + MongoDB + Redis + JWT  
**架构模式**: 微服务架构 + 模块化设计  
**业务模块**: 阅读端 + 写作端 + 共享底层服务  
**当前进度**: 约 40%（包含新增模块化设计）

---

##  新增模块化架构设计

### 业务模块划分

#### 1. 阅读端模块 (Reading Module)

```bash
reading/
 bookstore/          # 书城系统
 recommendation/     # 个性化推荐
 reader/            # 阅读器
 social/            # 社交功能（段评、书圈）
 task/              # 阅读任务
 vocabulary/        # 生词本
```

**核心功能**:

- 书城首页：轮播Banner + 四类榜单（实时/周/月/新人）
- 个性化推荐：协同过滤 + 内容标签，首页瀑布流20本
- 阅读器：章节正文、字体/背景/翻页设置、划线注记
- 段评系统：按句ID发评，点赞排序，折叠展示
- 书圈功能：每本书话题圈，发帖+点赞
- 阅读任务：每日30分钟打卡，代币奖励，Redis Bitmap记时长
- 生词本：划词查询、词典API集成、CSV导出

#### 2. 写作端模块 (Writing Module)

```bash
writing/
 editor/             # 编辑器系统
 encyclopedia/       # 设定百科
 ai_assistant/       # AI辅助功能
 content_review/     # 内容审核
 statistics/         # 数据统计
 monetization/       # 稿费结算
```

**核心功能**:

- 编辑器：Markdown + 富文本双Tab，自动保存30秒
- 设定百科：角色/地图/功法三级分类，关系图预览
- 敏感词检测：实时检测高亮，调用ai-service
- AI续写：选中段落一键续写200字，模型可切换
- 数据统计：每章完读率、跳章率，折线图展示
- 稿费结算：订阅+打赏+广告三分账，支付宝提现

#### 3. 共享底层服务 (Shared Services)

```bash
shared/
 auth/               # 账号与权限
 wallet/             # 钱包系统
 recommendation/     # 推荐服务
 messaging/          # 消息队列
 storage/            # 文件存储
 admin/              # 管理后台
```

**核心功能**:

- 账号权限：手机+邮箱双通道，JWT刷新，Reader/Author/Admin三角色
- 钱包系统：代币充值/消费/提现，雪花算法订单号
- 推荐服务：离线协同过滤，在线Top-N，gRPC对内
- 消息队列：Kafka埋点（阅读时长/点赞/完读），Flink计算
- 文件存储：章节正文OSS，URL与MD5存储
- 管理后台：书籍审核、榜单干预、提现审核

---

## 项目完成度总览

```markdown
总体进度: 45% (更新于 2025-10-13)

 基础设施: 100% ✅ (配置、数据库、服务器、迁移工具)
 架构设计: 100% ✅ (规则、文档、结构)
 模块化设计: 100% ✅ (阅读端、写作端、共享服务文档)
 共享服务: 100% ✅ (认证、钱包、存储、管理后台)
  路由层: 85% (结构完成，大部分处理函数已实现)
 业务逻辑: 15% (共享服务完成，Bookstore编译修复)
 功能实现: 10% (基础功能已实现)
```

---

## 已完成部分

### 1. 项目架构设计 (100%)

- [x] 完整的分层架构设计文档
- [x] 清晰的项目规则和开发规范
- [x] 依赖关系链定义：Router -> API -> Service -> Model
- [x] 开发规范和命名约定
- [x] **新增**: 阅读端模块设计文档
- [x] **新增**: 写作端模块设计文档
- [x] **新增**: 共享底层服务设计文档

### 2. 配置管理 (100%)

- [x] 配置分离架构完成
- [x] 数据库配置 (config/database.go)
- [x] 服务器配置 (config/server.go)
- [x] JWT配置 (config/jwt.go)
- [x] 配置工具函数 (config/utils.go)
- [x] 主配置文件 (config/config.go)

### 3. 核心基础设施 (100%) ✅

- [x] MongoDB连接初始化 (core/init_db.go)
- [x] 服务器启动和优雅关闭 (core/server.go)
- [x] 全局变量管理 (global/global.go)
- [x] 主程序入口 (main.go)
- [x] 依赖管理 (go.mod)
- [x] 优雅关闭机制
- [x] 数据库迁移工具 (migration/)
- [x] 前端通用组件 (Loading/Empty/错误页面)

### 4. 路由层 (80%)

- [x] 路由注册系统 (
outer/enter.go)
- [x] 系统路由结构 (
outer/system/sys_user.go)
- [x] 文档路由结构 (
outer/document/doc_document.go)
- [x] 健康检查端点 (/ping)
- [ ] 路由处理函数实现

---

## 更新后的任务规划

### MVP阶段开发优先级

#### 阶段一：阅读端核心功能 (优先级：最高)

1. **书城系统**
   - [ ] 书籍模型和基础CRUD
   - [ ] 书城首页API（Banner + 榜单）
   - [ ] 书籍详情页API
   - 预计时间：12小时

2. **基础阅读器**
   - [ ] 章节内容展示API
   - [ ] 阅读进度记录
   - [ ] 基础阅读设置
   - 预计时间：8小时

3. **简单推荐算法**
   - [ ] 基于热度的推荐
   - [ ] 首页瀑布流API
   - 预计时间：6小时

#### 阶段二：写作端核心功能 (优先级：高)

1. **基础编辑器**
   - [ ] 文档创建和编辑API
   - [ ] 自动保存机制
   - [ ] Markdown支持
   - 预计时间：10小时

2. **设定百科**
   - [ ] 角色/地图/功法分类管理
   - [ ] 基础CRUD操作
   - 预计时间：8小时

3. **AI续写功能**
   - [ ] 集成AI服务
   - [ ] 续写API接口
   - 预计时间：6小时

#### 阶段三：共享底层服务 (优先级：高)

1. **账号权限系统**
   - [ ] 用户注册/登录
   - [ ] JWT认证中间件
   - [ ] 角色权限管理
   - 预计时间：12小时

2. **钱包系统**
   - [ ] 代币充值/消费
   - [ ] 订单管理
   - [ ] 基础提现功能
   - 预计时间：10小时

#### 阶段四：高级功能 (优先级：中)

1. **阅读任务系统**
   - [ ] 每日打卡功能
   - [ ] 代币奖励机制
   - [ ] Redis时长统计
   - 预计时间：8小时

2. **社交功能**
   - [ ] 段评系统
   - [ ] 书圈功能
   - 预计时间：12小时

3. **数据统计**
   - [ ] 阅读数据分析
   - [ ] 收入统计
   - 预计时间：8小时

---

## 更新后的时间规划

### 第一阶段：阅读端MVP (2周)

- **Week 1**: 书城系统 + 基础阅读器 (20小时)
- **Week 2**: 推荐算法 + 测试优化 (10小时)

### 第二阶段：写作端MVP (2周)  

- **Week 3**: 基础编辑器 + 设定百科 (18小时)
- **Week 4**: AI续写 + 测试优化 (10小时)

### 第三阶段：共享服务 (2周)

- **Week 5**: 账号权限系统 (12小时)
- **Week 6**: 钱包系统 (10小时)

### 第四阶段：高级功能 (2周)

- **Week 7**: 阅读任务 + 社交功能 (20小时)
- **Week 8**: 数据统计 + 整体测试 (12小时)

**总预计时间**: 112小时 (约14个工作日)

---

## 文档结构更新

### 新增设计文档

```markdown
doc/design/
 reading/            # 阅读端模块设计
    README.md      # 阅读端总体设计
 writing/           # 写作端模块设计  
    README.md      # 写作端总体设计
 shared/            # 共享服务设计
     README.md      # 共享服务总体设计
```

### 相关文档链接

[阅读端模块设计](README_阅读端模块设计文档.md)))[写作端模块设计](README_写作端模块设计文档.md))))  
-[共享底层服务设计](README_共享底层服务设计文档.md))

---

## 快速开始指南

### MVP开发顺序建议

```markdown
1. 账号权限系统 (共享服务)
2. 书城系统 (阅读端)
3. 基础编辑器 (写作端)
4. 钱包系统 (共享服务)
5. 阅读器功能 (阅读端)
6. AI续写功能 (写作端)
```

### 立即可以开始的任务

1. **实现用户模型和认证** - 所有模块的基础
2. **实现书籍模型和书城API** - 阅读端核心
3. **实现文档模型和编辑API** - 写作端核心

---

## 开发注意事项

### 模块化开发原则

- 各模块保持相对独立，通过接口通信
- 共享服务为其他模块提供基础能力
- 阅读端和写作端可以并行开发

### 技术栈扩展

- **Redis**: 缓存、会话管理、阅读时长统计
- **Kafka**: 消息队列、数据埋点
- **OSS**: 文件存储、CDN加速
- **AI服务**: 续写、推荐、内容审核

### MVP范围控制

- 优先实现核心功能，保证基本可用
- 社交功能、高级推荐算法等可后续迭代
- 管理后台功能可最后实现

---

## 关联文档

[阅读端模块设计](README_阅读端模块设计文档.md)))[写作端模块设计](README_写作端模块设计文档.md))))
-[共享底层服务设计](README_共享底层服务设计文档.md))
-[软件需求规格说明书(SRS)](软件需求规格说明书(SRS).md))
-[架构设计规范](架构设计规范.md))
-[API接口总览](API接口总览.md))
