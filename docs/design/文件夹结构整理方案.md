# Qingyu_backend æ–‡ä»¶å¤¹ç»“æ„æ•´ç†æ–¹æ¡ˆ

> **æ–‡æ¡£çŠ¶æ€ï¼š** å¾…ä¸»äººå®¡æ ¸
> **åˆ›å»ºæ—¥æœŸï¼š** 2026-01-30
> **ä½œè€…ï¼š** çŒ«å¨˜Kore
> **ç»´æŠ¤è€…ï¼š** yukin371

---

## ğŸ“‹ ç›®å½•

1. [ç°çŠ¶åˆ†æ](#ä¸€ç°çŠ¶åˆ†æ)
2. [ä¾èµ–å…³ç³»åˆ†æ](#äºŒä¾èµ–å…³ç³»åˆ†æ)
3. [é£é™©è¯„ä¼°](#ä¸‰é£é™©è¯„ä¼°)
4. [æ•´ç†å»ºè®®æ–¹æ¡ˆ](#å››æ•´ç†å»ºè®®æ–¹æ¡ˆ)
5. [æ‰§è¡Œæ­¥éª¤è¯¦ç»†æ¸…å•](#äº”æ‰§è¡Œæ­¥éª¤è¯¦ç»†æ¸…å•)
6. [æœ€ç»ˆå»ºè®®](#å…­æœ€ç»ˆå»ºè®®)

---

## ä¸€ã€ç°çŠ¶åˆ†æ

### 1.1 migration vs migrations ç›®å½•å¯¹æ¯”

| ç›®å½• | è·¯å¾„ | æ–‡ä»¶æ•° | å¼•ç”¨æ¬¡æ•° | çŠ¶æ€ | ä¸»è¦ç”¨é€” |
|------|------|--------|----------|------|----------|
| **migration** | `/migration` | 27ä¸ªæ–‡ä»¶ | **7æ¬¡** (6ä¸ªæ–‡ä»¶) | âœ… æ´»è·ƒ | æ ¸å¿ƒæ•°æ®åº“è¿ç§»ç³»ç»Ÿ |
| **migrations** | `/migrations` | 1ä¸ªæ–‡ä»¶ | **0æ¬¡** | âš ï¸ å­¤ç«‹ | èŠå¤©ä¼šè¯è¿ç§»è„šæœ¬ |
| **migration (disabled)** | `/repository/mongodb/migration` | 1ä¸ª.disabledæ–‡ä»¶ | **0æ¬¡** | âŒ å·²åºŸå¼ƒ | æ•°æ®è¿ç§»å·¥å…· |

#### è¯¦ç»†æ–‡ä»¶æ¸…å•

**migration/ ç›®å½•ï¼ˆæ´»è·ƒä½¿ç”¨ï¼‰ï¼š**
```
migration/
â”œâ”€â”€ manager.go              # è¿ç§»ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ migrate.go              # è¿ç§»æ‰§è¡Œ
â”œâ”€â”€ migrate_test.go         # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ category_id_migration.go # åˆ†ç±»IDè¿ç§»
â”œâ”€â”€ README.md               # ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ examples/               # ç¤ºä¾‹è¿ç§»
â”‚   â”œâ”€â”€ 001_add_user_indexes.go
â”‚   â”œâ”€â”€ 002_add_book_fields.go
â”‚   â””â”€â”€ 003_multi_role_rbac.go
â”œâ”€â”€ seeds/                  # ç§å­æ•°æ®
â”‚   â”œâ”€â”€ users.go
â”‚   â”œâ”€â”€ categories.go
â”‚   â”œâ”€â”€ books.go
â”‚   â”œâ”€â”€ chapters.go
â”‚   â”œâ”€â”€ social.go
â”‚   â”œâ”€â”€ wallets.go
â”‚   â””â”€â”€ enhanced_users.go
â””â”€â”€ mongodb/                # MongoDBç´¢å¼•è¿ç§»
    â”œâ”€â”€ 002_create_users_indexes.go
    â”œâ”€â”€ 003_create_books_indexes_p0.go
    â”œâ”€â”€ 004_create_chapters_indexes.go
    â””â”€â”€ 005_create_reading_progress_indexes.go
```

**migrations/ ç›®å½•ï¼ˆå­¤ç«‹ï¼‰ï¼š**
```
migrations/
â””â”€â”€ chat_session_optimize_migration.go  # 366è¡Œç‹¬ç«‹è¿ç§»è„šæœ¬ï¼ˆæ— å¼•ç”¨ï¼‰
```

**repository/mongodb/migration/ï¼ˆå·²åºŸå¼ƒï¼‰ï¼š**
```
repository/mongodb/migration/
â””â”€â”€ data_migration.go.disabled  # 515è¡Œæ•°æ®è¿ç§»å·¥å…·ï¼ˆå·²ç¦ç”¨ï¼‰
```

#### ä¾èµ–å…³ç³»åˆ†æ

**migration/ çš„å¼•ç”¨è€…ï¼š**
```
cmd/migrate/main.go          âœ… ä¸»è¦ä½¿ç”¨è€…
cmd/seed_data/main.go        âœ… ç§å­æ•°æ®å¯¼å…¥
cmd/seed_data/auto.go        âœ… è‡ªåŠ¨ç§å­æ•°æ®
cmd/import_novels/main.go    âœ… å°è¯´å¯¼å…¥å·¥å…·
cmd/import_novels_auto/main.go âœ… è‡ªåŠ¨å°è¯´å¯¼å…¥
cmd/init_test_data/main.go   âœ… æµ‹è¯•æ•°æ®åˆå§‹åŒ–
```

**å…³é”®å‘ç°ï¼š**
- `migration/` æ˜¯é¡¹ç›®æ ¸å¿ƒè¿ç§»ç³»ç»Ÿï¼Œè¢«6ä¸ªcmdå·¥å…·ä¾èµ–
- `migrations/` çš„è„šæœ¬ä»æœªè¢«å¼•ç”¨ï¼Œå¯èƒ½æ˜¯ä¸´æ—¶è„šæœ¬æˆ–å†å²é—ç•™
- `repository/mongodb/migration/` å·²è¢«æ ‡è®°ä¸º `.disabled`ï¼Œæ˜¯æ··åˆæ¶æ„è¿ç§»çš„é—ç•™ä»£ç 

---

### 1.2 config vs configs ç›®å½•å¯¹æ¯”

| ç›®å½• | è·¯å¾„ | æ–‡ä»¶æ•° | å¼•ç”¨æ¬¡æ•° | çŠ¶æ€ | ä¸»è¦ç”¨é€” |
|------|------|--------|----------|------|----------|
| **config** | `/config` | 27ä¸ªæ–‡ä»¶ | **36æ¬¡** | âœ… æ ¸å¿ƒ | å…¨å±€é…ç½®ç³»ç»Ÿ |
| **configs** | `/configs` | 2ä¸ªYAML | **0æ¬¡** | ğŸ“„ é™æ€ | é…ç½®æ–‡ä»¶å­˜å‚¨ |
| **pkg/config** | `/pkg/config` | 1ä¸ªæ–‡ä»¶ | **0æ¬¡** | âŒ æœªä½¿ç”¨ | é€šç”¨é…ç½®ç®¡ç†å™¨ |
| **cmd/seeder/config** | `/cmd/seeder/config` | 1ä¸ªæ–‡ä»¶ | **10æ¬¡** | ğŸ”§ å·¥å…· | Seederé…ç½® |

#### è¯¦ç»†æ–‡ä»¶æ¸…å•

**config/ ç›®å½•ï¼ˆæ ¸å¿ƒé…ç½®ç³»ç»Ÿï¼‰ï¼š**
```
config/
â”œâ”€â”€ config.go              # ä¸»é…ç½®æ–‡ä»¶ï¼ˆ506è¡Œï¼‰
â”œâ”€â”€ database.go            # æ•°æ®åº“é…ç½®
â”œâ”€â”€ cache.go               # ç¼“å­˜é…ç½®
â”œâ”€â”€ jwt.go                 # JWTé…ç½®
â”œâ”€â”€ redis.go               # Redisé…ç½®
â”œâ”€â”€ oauth_config.go        # OAuthé…ç½®
â”œâ”€â”€ reload.go              # é…ç½®çƒ­é‡è½½
â”œâ”€â”€ feature_flags.go       # åŠŸèƒ½å¼€å…³
â”œâ”€â”€ validation.go          # é…ç½®éªŒè¯
â”œâ”€â”€ viper_integration.go   # Viperé›†æˆ
â”œâ”€â”€ config.yaml            # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.docker.yaml     # Dockeré…ç½®
â”œâ”€â”€ config.test.yaml       # æµ‹è¯•é…ç½®
â”œâ”€â”€ config.test.yaml.example
â”œâ”€â”€ migration_example.yaml
â”œâ”€â”€ search_indices.yaml    # æœç´¢ç´¢å¼•é…ç½®
â””â”€â”€ *_test.go             # å¤šä¸ªæµ‹è¯•æ–‡ä»¶
```

**configs/ ç›®å½•ï¼ˆé™æ€é…ç½®æ–‡ä»¶ï¼‰ï¼š**
```
configs/
â”œâ”€â”€ middleware.yaml        # ä¸­é—´ä»¶é…ç½®ï¼ˆ5008å­—èŠ‚ï¼‰
â””â”€â”€ permissions.yaml       # æƒé™é…ç½®ï¼ˆ2979å­—èŠ‚ï¼‰
```

**pkg/config/ï¼ˆæœªä½¿ç”¨ï¼‰ï¼š**
```
pkg/config/
â””â”€â”€ config.go             # é€šç”¨é…ç½®ç®¡ç†å™¨ï¼ˆ390è¡Œï¼Œæ— å¼•ç”¨ï¼‰
```

**cmd/seeder/config/ï¼ˆç‹¬ç«‹å·¥å…·ï¼‰ï¼š**
```
cmd/seeder/config/
â””â”€â”€ config.go             # Seederé…ç½®ï¼ˆ61è¡Œï¼Œä»…seederä½¿ç”¨ï¼‰
```

#### ä¾èµ–å…³ç³»åˆ†æ

**config/ çš„å¼•ç”¨è€…ï¼ˆ36ä¸ªæ–‡ä»¶ï¼‰ï¼š**
```
æ ¸å¿ƒæœåŠ¡ï¼š
â”œâ”€â”€ cmd/server/main.go              âœ… ä¸»æœåŠ¡å™¨
â”œâ”€â”€ core/server.go                  âœ… æœåŠ¡å™¨æ ¸å¿ƒ
â”œâ”€â”€ service/container/service_container.go âœ… æœåŠ¡å®¹å™¨
â”œâ”€â”€ service/shared/config_service.go âœ… é…ç½®æœåŠ¡
â”œâ”€â”€ service/ai/adapter/manager.go   âœ… AIé€‚é…å™¨
â”œâ”€â”€ service/ai/quota_service.go     âœ… AIé…é¢æœåŠ¡
â”œâ”€â”€ middleware/jwt.go               âœ… JWTä¸­é—´ä»¶
â””â”€â”€ repository/mongodb/factory.go   âœ… ä»“å‚¨å·¥å‚

å‘½ä»¤è¡Œå·¥å…·ï¼š
â”œâ”€â”€ cmd/seed_data/main.go & auto.go
â”œâ”€â”€ cmd/import_novels/main.go & auto.go
â”œâ”€â”€ cmd/init_test_data/main.go
â”œâ”€â”€ cmd/check_books/main.go
â”œâ”€â”€ cmd/update_book_fields/main.go
â””â”€â”€ å…¶ä»–10+ä¸ªcmdå·¥å…·

æµ‹è¯•æ–‡ä»¶ï¼š
â”œâ”€â”€ test/integration/*_test.go      âœ… 9ä¸ªé›†æˆæµ‹è¯•
â”œâ”€â”€ test/e2e/framework/environment.go
â”œâ”€â”€ test/testutil/*
â””â”€â”€ scripts/*

å…¶ä»–æ¨¡å—ï¼š
â”œâ”€â”€ pkg/cache/redis_client.go
â”œâ”€â”€ pkg/cron/backup_task.go
â””â”€â”€ service/user/verification_service.go
```

**configs/ çš„å¼•ç”¨æƒ…å†µï¼š**
- âš ï¸ **æ— Goä»£ç å¼•ç”¨**ï¼Œåªæœ‰YAMLé…ç½®æ–‡ä»¶
- å¯èƒ½è¢«æ¡†æ¶åŠ¨æ€è¯»å–ï¼ˆå¦‚middleware.yamlã€permissions.yamlï¼‰

**å…³é”®å‘ç°ï¼š**
- `config/` æ˜¯é¡¹ç›®æ ¸å¿ƒé…ç½®ç³»ç»Ÿï¼Œè¢«36ä¸ªæ–‡ä»¶ä¾èµ–ï¼Œæ˜¯æ•´ä¸ªé¡¹ç›®çš„é…ç½®ä¸­æ¢
- `configs/` åªå­˜å‚¨é™æ€é…ç½®æ–‡ä»¶ï¼Œæ— ä»£ç å¼•ç”¨
- `pkg/config/` å®Œå…¨æœªè¢«ä½¿ç”¨ï¼Œæ˜¯å†—ä½™ä»£ç 
- `cmd/seeder/config/` æ˜¯ç‹¬ç«‹å·¥å…·çš„é…ç½®ï¼Œåº”ä¿æŒç‹¬ç«‹

---

### 1.3 utils ç›®å½•åˆ†å¸ƒå¯¹æ¯”

| ç›®å½• | è·¯å¾„ | æ–‡ä»¶æ•° | å¼•ç”¨æ¬¡æ•° | çŠ¶æ€ | ä¸»è¦ç”¨é€” |
|------|------|--------|----------|------|----------|
| **utils** | `/utils` | 2ä¸ªæ–‡ä»¶ | **2æ¬¡** | ğŸ”§ ç‰¹å®š | ç« èŠ‚æ’åºå·¥å…· |
| **pkg/utils** | `/pkg/utils` | 2ä¸ªæ–‡ä»¶ | **1æ¬¡** | âš ï¸ ä½ä½¿ç”¨ | IPåœ°å€å·¥å…· |
| **cmd/seeder/utils** | `/cmd/seeder/utils` | 3ä¸ªæ–‡ä»¶ | **11æ¬¡** | ğŸ”§ å·¥å…· | Seederå·¥å…·é›† |

#### è¯¦ç»†æ–‡ä»¶æ¸…å•

**utils/ ç›®å½•ï¼ˆç« èŠ‚æ’åºï¼‰ï¼š**
```
utils/
â”œâ”€â”€ lexorank.go            # LexoRankæ’åºé”®ç”Ÿæˆï¼ˆ58è¡Œï¼‰
â””â”€â”€ lexorank_test.go       # æµ‹è¯•æ–‡ä»¶
```

**pkg/utils/ ç›®å½•ï¼ˆå‡ ä¹æœªä½¿ç”¨ï¼‰ï¼š**
```
pkg/utils/
â”œâ”€â”€ ip.go                  # IPåœ°å€å·¥å…·ï¼ˆ109è¡Œï¼‰
â””â”€â”€ sanitizer.go           # æ•°æ®æ¸…ç†å·¥å…·
```

**cmd/seeder/utils/ ç›®å½•ï¼ˆSeederå·¥å…·é›†ï¼‰ï¼š**
```
cmd/seeder/utils/
â”œâ”€â”€ mongodb.go             # MongoDBå·¥å…·ï¼ˆ111è¡Œï¼‰
â”œâ”€â”€ verify.go              # éªŒè¯å·¥å…·
â””â”€â”€ mongodb_test.go        # æµ‹è¯•æ–‡ä»¶
```

#### ä¾èµ–å…³ç³»åˆ†æ

**utils/ çš„å¼•ç”¨è€…ï¼š**
```
service/writer/document/duplicate_service.go       âœ… ç« èŠ‚å»é‡æœåŠ¡
service/writer/document/duplicate_service_test.go  âœ… æµ‹è¯•æ–‡ä»¶
```

**pkg/utils/ çš„å¼•ç”¨è€…ï¼š**
```
api/v1/user/handler/auth_handler.go                âš ï¸ ä»…1å¤„å¼•ç”¨
```

**cmd/seeder/utils/ çš„å¼•ç”¨è€…ï¼ˆ11ä¸ªæ–‡ä»¶ï¼‰ï¼š**
```
cmd/seeder/main.goã€seeder_users.goã€seeder_books.go
seeder_chapters.goã€seeder_social.goã€seeder_wallets.go
seeder_import.goã€seeder_test_data.goã€seeder_ai_quota.go
seeder_rankings.goã€relationships/builder.go
```

**å…³é”®å‘ç°ï¼š**
- `utils/` ä¸“é—¨ç”¨äºç« èŠ‚æ’åºåŠŸèƒ½ï¼ˆLexoRankç®—æ³•ï¼‰
- `pkg/utils/` å‡ ä¹æœªè¢«ä½¿ç”¨ï¼ˆåªæœ‰1å¤„å¼•ç”¨IPå·¥å…·ï¼‰
- `cmd/seeder/utils/` æ˜¯seederå·¥å…·çš„ä¸“ç”¨å‡½æ•°ï¼Œåº”ä¿æŒç‹¬ç«‹

---

## äºŒã€ä¾èµ–å…³ç³»åˆ†æ

### 2.1 Migration ä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       migration/                            â”‚
â”‚  (æ ¸å¿ƒè¿ç§»ç³»ç»Ÿ - è¢«å¼•ç”¨7æ¬¡)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  manager.go â”‚  â”‚  migrate.go â”‚  â”‚   seeds/    â”‚        â”‚
â”‚  â”‚  (258è¡Œ)    â”‚  â”‚  (æ‰§è¡Œå™¨)   â”‚  â”‚  (ç§å­æ•°æ®) â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â”€â”€â”€â–º cmd/migrate/main.go
              â”œâ”€â”€â”€â”€â–º cmd/seed_data/main.go
              â”œâ”€â”€â”€â”€â–º cmd/seed_data/auto.go
              â”œâ”€â”€â”€â”€â–º cmd/import_novels/main.go
              â”œâ”€â”€â”€â”€â–º cmd/import_novels_auto/main.go
              â””â”€â”€â”€â”€â–º cmd/init_test_data/main.go

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    migrations/ (å­¤ç«‹)                        â”‚
â”‚  chat_session_optimize_migration.go (366è¡Œ)                 â”‚
â”‚  âš ï¸ æ— ä»»ä½•å¼•ç”¨ - å¯èƒ½æ˜¯ä¸´æ—¶è„šæœ¬æˆ–å†å²é—ç•™                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        repository/mongodb/migration/ (å·²åºŸå¼ƒ)                â”‚
â”‚  data_migration.go.disabled (515è¡Œ)                         â”‚
â”‚  âŒ å·²ç¦ç”¨ - æ··åˆæ¶æ„è¿ç§»çš„é—ç•™ä»£ç                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Config ä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        config/                              â”‚
â”‚  (å…¨å±€é…ç½®ç³»ç»Ÿ - è¢«å¼•ç”¨36æ¬¡)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ config.go   â”‚  â”‚ database.go â”‚  â”‚  cache.go   â”‚         â”‚
â”‚  â”‚  (506è¡Œ)    â”‚  â”‚ jwt.go      â”‚  â”‚  redis.go   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º æ ¸å¿ƒæœåŠ¡ï¼ˆ8ä¸ªæ–‡ä»¶ï¼‰
       â”‚             â”œâ”€â”€ cmd/server/main.go
       â”‚             â”œâ”€â”€ core/server.go
       â”‚             â”œâ”€â”€ service/container/*
       â”‚             â”œâ”€â”€ service/ai/*
       â”‚             â””â”€â”€ middleware/jwt.go
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º å‘½ä»¤è¡Œå·¥å…·ï¼ˆ15ä¸ªæ–‡ä»¶ï¼‰
       â”‚             â”œâ”€â”€ cmd/seed_data/*
       â”‚             â”œâ”€â”€ cmd/import_novels/*
       â”‚             â””â”€â”€ cmd/check_*
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º æµ‹è¯•æ–‡ä»¶ï¼ˆ10ä¸ªæ–‡ä»¶ï¼‰
       â”‚             â”œâ”€â”€ test/integration/*
       â”‚             â””â”€â”€ test/e2e/*
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º å…¶ä»–æ¨¡å—ï¼ˆ3ä¸ªæ–‡ä»¶ï¼‰
                     â”œâ”€â”€ pkg/cache/redis_client.go
                     â”œâ”€â”€ pkg/cron/backup_task.go
                     â””â”€â”€ service/user/verification_service.go

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      configs/                               â”‚
â”‚  middleware.yamlã€permissions.yaml                            â”‚
â”‚  âš ï¸ æ— ä»£ç å¼•ç”¨ - ä»…å­˜å‚¨é™æ€é…ç½®æ–‡ä»¶                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     pkg/config/ (æœªä½¿ç”¨)                      â”‚
â”‚  config.go (390è¡Œ)                                            â”‚
â”‚  âŒ å®Œå…¨æ— å¼•ç”¨ - å†—ä½™ä»£ç                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 cmd/seeder/config/ (ç‹¬ç«‹)                    â”‚
â”‚  config.go (61è¡Œ)                                             â”‚
â”‚  âœ… ä»…seederå†…éƒ¨ä½¿ç”¨ï¼ˆ10ä¸ªæ–‡ä»¶ï¼‰ - åº”ä¿æŒç‹¬ç«‹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Utils ä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       utils/                                â”‚
â”‚  lexorank.go (58è¡Œ) - ç« èŠ‚æ’åº                              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â–º service/writer/document/duplicate_service.go
       â””â”€â”€â”€â”€â–º duplicate_service_test.go

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     pkg/utils/                              â”‚
â”‚  ip.go (109è¡Œ) - IPåœ°å€å·¥å…·                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â”€â”€â–º api/v1/user/handler/auth_handler.go âš ï¸ ä»…1å¤„å¼•ç”¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 cmd/seeder/utils/                           â”‚
â”‚  mongodb.go (111è¡Œ) - Seederå·¥å…·é›†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â–º cmd/seeder/main.go
       â”œâ”€â”€â”€â”€â–º seeder_users.go
       â”œâ”€â”€â”€â”€â–º seeder_books.go
       â”œâ”€â”€â”€â”€â–º seeder_chapters.go
       â”œâ”€â”€â”€â”€â–º seeder_social.go
       â”œâ”€â”€â”€â”€â–º seeder_wallets.go
       â”œâ”€â”€â”€â”€â–º seeder_import.go
       â”œâ”€â”€â”€â”€â–º seeder_test_data.go
       â”œâ”€â”€â”€â”€â–º seeder_ai_quota.go
       â”œâ”€â”€â”€â”€â–º seeder_rankings.go
       â””â”€â”€â”€â”€â–º relationships/builder.go
```

---

## ä¸‰ã€é£é™©è¯„ä¼°

### 3.1 é«˜é£é™©é¡¹

| é£é™©é¡¹ | é£é™©ç­‰çº§ | å½±å“èŒƒå›´ | ä¿®å¤éš¾åº¦ | è¯´æ˜ |
|--------|---------|----------|----------|------|
| **ä¿®æ”¹ config/ ç›®å½•** | ğŸ”´ é«˜ | 36ä¸ªæ–‡ä»¶ | å›°éš¾ | configæ˜¯é¡¹ç›®æ ¸å¿ƒé…ç½®ï¼Œå‡ ä¹æ‰€æœ‰æ¨¡å—éƒ½ä¾èµ–å®ƒ |
| **åˆå¹¶ config å’Œ configs** | ğŸ”´ é«˜ | 36+åŠ¨æ€è¯»å– | å›°éš¾ | configså¯èƒ½è¢«æ¡†æ¶åŠ¨æ€è¯»å–ï¼Œéœ€è¦æ·±å…¥è°ƒç ” |
| **é‡å‘½å migration/** | ğŸ”´ é«˜ | 7ä¸ªcmdå·¥å…· | ä¸­ç­‰ | å¤šä¸ªå‘½ä»¤è¡Œå·¥å…·ä¾èµ–ï¼Œéœ€è¦æ‰¹é‡ä¿®æ”¹import |
| **åˆ é™¤ utils/** | ğŸŸ¡ ä¸­ | 2ä¸ªæ–‡ä»¶ | å®¹æ˜“ | å½±å“èŒƒå›´å°ï¼Œä½†éœ€è¦éªŒè¯LexoRankç®—æ³• |

### 3.2 ä¸­é£é™©é¡¹

| é£é™©é¡¹ | é£é™©ç­‰çº§ | å½±å“èŒƒå›´ | ä¿®å¤éš¾åº¦ | è¯´æ˜ |
|--------|---------|----------|----------|------|
| **æ¸…ç† migrations/** | ğŸŸ¡ ä¸­ | 0ä¸ªå¼•ç”¨ | å®¹æ˜“ | è™½æ— å¼•ç”¨ï¼Œä½†éœ€è¦ç¡®è®¤æ˜¯å¦ä¸ºä¸´æ—¶è„šæœ¬ |
| **åˆå¹¶ utils åˆ° pkg/utils** | ğŸŸ¡ ä¸­ | 2ä¸ªæ–‡ä»¶ | å®¹æ˜“ | åŠŸèƒ½å•ä¸€ï¼Œéœ€è¦éªŒè¯å‘½åå†²çª |
| **åˆ é™¤ pkg/config** | ğŸŸ¢ ä½ | 0ä¸ªå¼•ç”¨ | å®¹æ˜“ | å®Œå…¨æœªä½¿ç”¨ï¼Œå¯å®‰å…¨åˆ é™¤ |

### 3.3 æŠ€æœ¯é£é™©ç‚¹

1. **Import è·¯å¾„ç ´åé£é™©**
   - ä¿®æ”¹ç›®å½•åç§°ä¼šå¯¼è‡´æ‰€æœ‰importè·¯å¾„å¤±æ•ˆ
   - éœ€è¦å…¨å±€æœç´¢æ›¿æ¢å’Œå…¨é¢æµ‹è¯•
   - å¯èƒ½å½±å“å¤–éƒ¨ä¾èµ–ï¼ˆå¦‚æœæœ‰ï¼‰

2. **åŠ¨æ€é…ç½®è¯»å–é£é™©**
   - `configs/` çš„YAMLæ–‡ä»¶å¯èƒ½è¢«æ¡†æ¶åŠ¨æ€è¯»å–
   - åˆ é™¤å‰éœ€è¦ç¡®è®¤æ²¡æœ‰ç¡¬ç¼–ç çš„è·¯å¾„å¼•ç”¨
   - å»ºè®®ä½¿ç”¨grepæœç´¢configså­—ç¬¦ä¸²

3. **æµ‹è¯•è¦†ç›–ä¸è¶³é£é™©**
   - æŸäº›å·¥å…·å‡½æ•°å¯èƒ½ç¼ºå°‘æµ‹è¯•
   - æ•´åˆåå¯èƒ½å¼•å…¥éšè—bug
   - éœ€è¦è¡¥å……æµ‹è¯•ç”¨ä¾‹

4. **å›¢é˜Ÿåä½œé£é™©**
   - æ–‡ä»¶å¤¹ç»“æ„å˜åŒ–ä¼šå½±å“å›¢é˜Ÿå¼€å‘ä¹ æƒ¯
   - éœ€è¦æ›´æ–°æ–‡æ¡£å’Œè§„èŒƒ
   - å»ºè®®å›¢é˜Ÿreviewåå†æ‰§è¡Œ

---

## å››ã€æ•´ç†å»ºè®®æ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šæ¿€è¿›åˆå¹¶æ–¹æ¡ˆï¼ˆä¸æ¨èï¼‰

**ç›®æ ‡ï¼š** ç»Ÿä¸€æ‰€æœ‰é‡å¤ç›®å½•ï¼Œç®€åŒ–é¡¹ç›®ç»“æ„

**æ‰§è¡Œæ­¥éª¤ï¼š**
1. **migration æ•´åˆ**
   - å°† `migrations/chat_session_optimize_migration.go` ç§»åˆ° `migration/examples/`
   - åˆ é™¤ `repository/mongodb/migration/`ï¼ˆå·²åºŸå¼ƒï¼‰
   - é‡å‘½å `migration/` ä¸º `migrations/` ä»¥ç¬¦åˆGoæƒ¯ä¾‹

2. **config æ•´åˆ**
   - å°† `configs/` çš„YAMLæ–‡ä»¶ç§»åˆ° `config/resources/`
   - åˆ é™¤ `pkg/config/`ï¼ˆæœªä½¿ç”¨ï¼‰
   - ä¿æŒ `cmd/seeder/config/` ç‹¬ç«‹

3. **utils æ•´åˆ**
   - å°† `utils/lexorank.go` ç§»åˆ° `pkg/utils/`
   - åˆ é™¤æ ¹ç›®å½•çš„ `utils/`
   - æ›´æ–°æ‰€æœ‰importè·¯å¾„

4. **æ›´æ–°å¼•ç”¨**
   - å…¨å±€æ›¿æ¢importè·¯å¾„ï¼ˆ36+2+7=45å¤„ï¼‰
   - è¿è¡Œ `go mod tidy`
   - å…¨é¢æµ‹è¯•

**ä¼˜ç‚¹ï¼š**
- âœ… ç›®å½•ç»“æ„ç»Ÿä¸€æ¸…æ™°
- âœ… å‡å°‘æ··æ·†
- âœ… ç¬¦åˆGoé¡¹ç›®è§„èŒƒ

**ç¼ºç‚¹ï¼š**
- âŒ éœ€è¦ä¿®æ”¹45å¤„import
- âŒ é«˜é£é™©ï¼Œå¯èƒ½ç ´åç°æœ‰åŠŸèƒ½
- âŒ æµ‹è¯•å·¥ä½œé‡å¤§
- âŒ å¯èƒ½å½±å“å›¢é˜Ÿå¼€å‘æ•ˆç‡

**é£é™©ç­‰çº§ï¼š** ğŸ”´ **é«˜é£é™©** - ä¸å»ºè®®åœ¨é¡¹ç›®ç¨³å®šæœŸæ‰§è¡Œ

---

### æ–¹æ¡ˆBï¼šä¿å®ˆä¿æŒæ–¹æ¡ˆï¼ˆæ¨èçŸ­æœŸï¼‰

**ç›®æ ‡ï¼š** ä¿æŒç°çŠ¶ï¼Œé€šè¿‡æ–‡æ¡£å’Œè§„èŒƒç®¡ç†

**æ‰§è¡Œæ­¥éª¤ï¼š**
1. **æ·»åŠ  README æ–‡æ¡£**
   - ä¸ºæ¯ä¸ªç›®å½•æ·»åŠ READMEè¯´æ˜ç”¨é€”
   - åœ¨é¡¹ç›®æ–‡æ¡£ä¸­æ˜ç¡®ç›®å½•ç»“æ„è§„èŒƒ
   - æ ‡æ³¨åºŸå¼ƒç›®å½•

2. **æ ‡è®°åºŸå¼ƒä»£ç **
   - åœ¨ `pkg/config/` æ·»åŠ æ³¨é‡Šï¼š`// DEPRECATED: æœªä½¿ç”¨ï¼Œè®¡åˆ’åœ¨v2.0åˆ é™¤`
   - åœ¨ `repository/mongodb/migration/` æ·»åŠ è¯´æ˜ï¼š`// DISABLED: å·²åºŸå¼ƒ`

3. **å»ºç«‹è§„èŒƒ**
   - åˆ›å»º `CONTRIBUTING.md` è¯´æ˜ç›®å½•ç»“æ„è§„èŒƒ
   - æ·»åŠ  golangci-lint è§„åˆ™æ£€æŸ¥é”™è¯¯å¼•ç”¨
   - åœ¨ PR æ¨¡æ¿ä¸­æ·»åŠ ç›®å½•ç»“æ„æ£€æŸ¥é¡¹

4. **æ–‡æ¡£åŒ–**
   ```
   é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜ï¼š

   â”œâ”€â”€ config/          # æ ¸å¿ƒé…ç½®ç³»ç»Ÿï¼ˆå…¨å±€é…ç½®ï¼Œ36å¤„å¼•ç”¨ï¼‰
   â”œâ”€â”€ configs/         # é™æ€é…ç½®æ–‡ä»¶ï¼ˆYAMLï¼ŒåŠ¨æ€è¯»å–ï¼‰
   â”œâ”€â”€ migration/       # æ•°æ®åº“è¿ç§»ç³»ç»Ÿï¼ˆæ´»è·ƒä½¿ç”¨ï¼Œ7å¤„å¼•ç”¨ï¼‰
   â”œâ”€â”€ migrations/      # âš ï¸ å†å²é—ç•™ï¼Œè®¡åˆ’è¿ç§»åˆ°migration/examples/
   â”œâ”€â”€ pkg/config/      # âŒ å·²åºŸå¼ƒï¼Œè®¡åˆ’åˆ é™¤
   â”œâ”€â”€ utils/           # ç« èŠ‚æ’åºå·¥å…·ï¼ˆLexoRankï¼Œ2å¤„å¼•ç”¨ï¼‰
   â”œâ”€â”€ pkg/utils/       # é€šç”¨å·¥å…·å‡½æ•°ï¼ˆ1å¤„å¼•ç”¨ï¼‰
   â””â”€â”€ cmd/seeder/utils/ # Seederä¸“ç”¨å·¥å…·ï¼ˆ11å¤„å¼•ç”¨ï¼‰
   ```

**ä¼˜ç‚¹ï¼š**
- âœ… é›¶é£é™©ï¼Œä¸ç ´åç°æœ‰åŠŸèƒ½
- âœ… å¿«é€Ÿå®æ–½ï¼Œæ— éœ€å¤§è§„æ¨¡é‡æ„
- âœ… é€šè¿‡æ–‡æ¡£å‡å°‘æ··æ·†

**ç¼ºç‚¹ï¼š**
- âŒ æ— æ³•è§£å†³ç»“æ„æ··ä¹±é—®é¢˜
- âŒ æ–°å¼€å‘è€…ä»å¯èƒ½å›°æƒ‘
- âŒ åºŸå¼ƒä»£ç æŒç»­å ç”¨ç©ºé—´

**é£é™©ç­‰çº§ï¼š** ğŸŸ¢ **é›¶é£é™©** - é€‚åˆé¡¹ç›®ç¨³å®šæœŸ

---

### æ–¹æ¡ˆCï¼šæ¸è¿›å¼æ•´ç†æ–¹æ¡ˆï¼ˆæ¨èé•¿æœŸï¼‰â­

**ç›®æ ‡ï¼š** åˆ†é˜¶æ®µé€æ­¥æ•´ç†ï¼Œé™ä½é£é™©

#### ç¬¬ä¸€é˜¶æ®µï¼šæ¸…ç†æ˜æ˜¾åºŸå¼ƒï¼ˆP0ä¼˜å…ˆçº§ï¼‰

**æ‰§è¡Œå†…å®¹ï¼š**
1. **åˆ é™¤æˆ–å½’æ¡£æœªä½¿ç”¨çš„ç›®å½•**
   - [ ] åˆ é™¤ `pkg/config/`ï¼ˆ0æ¬¡å¼•ç”¨ï¼‰
   - [ ] å½’æ¡£ `repository/mongodb/migration/`ï¼ˆå·²ç¦ç”¨ï¼‰
   - [ ] ç§»åŠ¨ `migrations/chat_session_optimize_migration.go` åˆ° `migration/examples/`

2. **æ·»åŠ æ–‡æ¡£è¯´æ˜**
   - [ ] åœ¨ `config/` æ·»åŠ README.mdè¯´æ˜é…ç½®ç³»ç»Ÿæ¶æ„
   - [ ] åœ¨ `migration/` æ·»åŠ æ¶æ„å›¾å’Œè¿ç§»æµç¨‹
   - [ ] åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `FOLDER_STRUCTURE.md`

3. **éªŒæ”¶æ ‡å‡†**
   - `go build ./...` ç¼–è¯‘é€šè¿‡
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡
   - æ–‡æ¡£å®Œæ•´

**é¢„è®¡æ—¶é—´ï¼š** 1-2å¤©
**é£é™©ç­‰çº§ï¼š** ğŸŸ¢ ä½é£é™©

---

#### ç¬¬äºŒé˜¶æ®µï¼šç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆP1ä¼˜å…ˆçº§ï¼‰

**æ‰§è¡Œå†…å®¹ï¼š**
1. **é‡å‘½å configs/ ä¸ºæ›´æ¸…æ™°çš„åç§°**
   - `configs/` â†’ `config/resources/`
   - æœç´¢ç¡®è®¤æ²¡æœ‰ç¡¬ç¼–ç è·¯å¾„å¼•ç”¨

2. **ä¼˜åŒ–é…ç½®æ–‡ä»¶ç»„ç»‡**
   ```
   config/
   â”œâ”€â”€ config.go           # ä¸»é…ç½®
   â”œâ”€â”€ database.go         # æ•°æ®åº“é…ç½®
   â”œâ”€â”€ resources/          # é™æ€èµ„æºï¼ˆåŸconfigs/ï¼‰
   â”‚   â”œâ”€â”€ middleware.yaml
   â”‚   â””â”€â”€ permissions.yaml
   â””â”€â”€ *.yaml              # ç¯å¢ƒé…ç½®æ–‡ä»¶
   ```

3. **éªŒæ”¶æ ‡å‡†**
   - æ¡†æ¶èƒ½æ­£å¸¸è¯»å–é…ç½®æ–‡ä»¶
   - æœåŠ¡æ­£å¸¸å¯åŠ¨
   - ä¸­é—´ä»¶å’Œæƒé™åŠŸèƒ½æ­£å¸¸

**é¢„è®¡æ—¶é—´ï¼š** 2-3å¤©
**é£é™©ç­‰çº§ï¼š** ğŸŸ¡ ä¸­é£é™©ï¼ˆéœ€è¦æ·±å…¥æµ‹è¯•ï¼‰

---

#### ç¬¬ä¸‰é˜¶æ®µï¼šå·¥å…·å‡½æ•°æ•´åˆï¼ˆP2ä¼˜å…ˆçº§ï¼Œå¯é€‰ï¼‰

**æ‰§è¡Œå†…å®¹ï¼š**
1. **è¯„ä¼° utils/ çš„å¿…è¦æ€§**
   - å¦‚æœLexoRankåŠŸèƒ½åªè¢«writeræ¨¡å—ä½¿ç”¨ï¼Œè€ƒè™‘ç§»åˆ° `service/writer/utils/`
   - å¦‚æœæ˜¯é€šç”¨åŠŸèƒ½ï¼Œç§»åˆ° `pkg/utils/`

2. **æ•´åˆæ–¹æ¡ˆ**
   ```go
   // æ–¹æ¡ˆ1ï¼šç§»åˆ°pkg/utilsï¼ˆæ¨èï¼‰
   pkg/utils/
   â”œâ”€â”€ ip.go              # IPå·¥å…·ï¼ˆå·²å­˜åœ¨ï¼‰
   â”œâ”€â”€ sanitizer.go       # æ•°æ®æ¸…ç†ï¼ˆå·²å­˜åœ¨ï¼‰
   â””â”€â”€ lexorank.go        # æ’åºå·¥å…·ï¼ˆä»utils/ç§»å…¥ï¼‰

   // æ–¹æ¡ˆ2ï¼šä¿æŒç‹¬ç«‹
   internal/writer/utils/ # writerå†…éƒ¨å·¥å…·
   â””â”€â”€ lexorank.go
   ```

3. **éªŒæ”¶æ ‡å‡†**
   - æ›´æ–°2å¤„importè·¯å¾„
   - ç« èŠ‚æ’åºåŠŸèƒ½æ­£å¸¸
   - æµ‹è¯•é€šè¿‡

**é¢„è®¡æ—¶é—´ï¼š** 1å¤©
**é£é™©ç­‰çº§ï¼š** ğŸŸ¢ ä½é£é™©

---

## äº”ã€æ‰§è¡Œæ­¥éª¤è¯¦ç»†æ¸…å•

### ç¬¬ä¸€é˜¶æ®µæ‰§è¡Œæ¸…å•

```markdown
## 1. æ¸…ç†æœªä½¿ç”¨ç›®å½•

### 1.1 åˆ é™¤ pkg/config/
- [ ] ç¡®è®¤æ— å¼•ç”¨ï¼ˆå·²å®Œæˆï¼š0æ¬¡å¼•ç”¨ï¼‰
- [ ] åˆ é™¤ `pkg/config/config.go`
- [ ] è¿è¡Œ `go build ./...` éªŒè¯ç¼–è¯‘
- [ ] è¿è¡Œ `go test ./...` éªŒè¯æµ‹è¯•

### 1.2 å½’æ¡£ repository/mongodb/migration/
- [ ] ç§»åŠ¨åˆ° `docs/archived_codes/repository-mongodb-migration/`
- [ ] æ·»åŠ READMEè¯´æ˜åºŸå¼ƒåŸå› 
- [ ] åˆ é™¤åŸç›®å½•

### 1.3 å¤„ç† migrations/ ç›®å½•
- [ ] ç§»åŠ¨ `migrations/chat_session_optimize_migration.go` åˆ° `migration/examples/`
- [ ] åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ æ³¨é‡Šè¯´æ˜å†å²
- [ ] åˆ é™¤ç©ºçš„ `migrations/` ç›®å½•

## 2. æ·»åŠ æ–‡æ¡£

### 2.1 åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„æ–‡æ¡£
- [ ] åˆ›å»º `docs/FOLDER_STRUCTURE.md`
- [ ] è¯´æ˜å„ç›®å½•ç”¨é€”å’Œä¾èµ–å…³ç³»
- [ ] æ·»åŠ ç›®å½•ç»“æ„å›¾

### 2.2 ä¸ºå…³é”®ç›®å½•æ·»åŠ README
- [ ] `config/README.md` - é…ç½®ç³»ç»Ÿæ¶æ„
- [ ] `migration/README.md` - è¿ç§»ç³»ç»Ÿä½¿ç”¨æŒ‡å—ï¼ˆå·²å­˜åœ¨ï¼‰
- [ ] `pkg/utils/README.md` - å·¥å…·å‡½æ•°è¯´æ˜

### 2.3 æ ‡è®°åºŸå¼ƒä»£ç 
- [ ] åœ¨CONTRIBUTING.mdä¸­è¯´æ˜åºŸå¼ƒç›®å½•
- [ ] æ·»åŠ golangci-lintè§„åˆ™æ£€æŸ¥

## 3. éªŒè¯å’Œæµ‹è¯•
- [ ] è¿è¡Œ `go build ./...`
- [ ] è¿è¡Œ `go test ./...`
- [ ] å¯åŠ¨æœåŠ¡éªŒè¯åŠŸèƒ½
- [ ] CI/CDç®¡é“æ£€æŸ¥
```

---

### ç¬¬äºŒé˜¶æ®µæ‰§è¡Œæ¸…å•

```markdown
## 1. é‡å‘½åconfigs/

### 1.1 å‡†å¤‡å·¥ä½œ
- [ ] æœç´¢ä»£ç ä¸­æ‰€æœ‰ "configs" å­—ç¬¦ä¸²
- [ ] ç¡®è®¤æ²¡æœ‰ç¡¬ç¼–ç è·¯å¾„
- [ ] æ£€æŸ¥æ¡†æ¶é…ç½®åŠ è½½é€»è¾‘

### 1.2 æ‰§è¡Œé‡å‘½å
- [ ] åˆ›å»º `config/resources/` ç›®å½•
- [ ] ç§»åŠ¨ `configs/middleware.yaml` åˆ° `config/resources/`
- [ ] ç§»åŠ¨ `configs/permissions.yaml` åˆ° `config/resources/`
- [ ] åˆ é™¤ç©ºçš„ `configs/` ç›®å½•

### 1.3 æ›´æ–°å¼•ç”¨
- [ ] å¦‚æœæœ‰å¼•ç”¨ï¼Œæ›´æ–°é…ç½®æ–‡ä»¶è·¯å¾„
- [ ] æ›´æ–°æ–‡æ¡£ä¸­çš„è·¯å¾„è¯´æ˜

## 2. éªŒè¯é…ç½®åŠ è½½
- [ ] é‡å¯æœåŠ¡
- [ ] éªŒè¯ä¸­é—´ä»¶é…ç½®åŠ è½½
- [ ] éªŒè¯æƒé™é…ç½®åŠ è½½
- [ ] æ£€æŸ¥æ—¥å¿—æ— é”™è¯¯

## 3. æ–‡æ¡£æ›´æ–°
- [ ] æ›´æ–° `FOLDER_STRUCTURE.md`
- [ ] æ›´æ–°é…ç½®ç›¸å…³æ–‡æ¡£
- [ ] æäº¤å˜æ›´è¯´æ˜
```

---

### ç¬¬ä¸‰é˜¶æ®µæ‰§è¡Œæ¸…å•ï¼ˆå¯é€‰ï¼‰

```markdown
## 1. utilsæ•´åˆ

### 1.1 åŠŸèƒ½åˆ†æ
- [ ] ç¡®è®¤LexoRankçš„ä½¿ç”¨åœºæ™¯
- [ ] è¯„ä¼°æ˜¯å¦ä¸ºé€šç”¨åŠŸèƒ½
- [ ] å†³å®šç›®æ ‡ä½ç½®

### 1.2 æ‰§è¡Œç§»åŠ¨ï¼ˆæ¨èæ–¹æ¡ˆï¼‰
- [ ] ç§»åŠ¨ `utils/lexorank.go` åˆ° `pkg/utils/`
- [ ] æ›´æ–°packageå£°æ˜
- [ ] æ›´æ–°importè·¯å¾„ï¼š
  - `service/writer/document/duplicate_service.go`
  - `duplicate_service_test.go`
- [ ] åˆ é™¤ç©ºçš„ `utils/` ç›®å½•

### 1.3 éªŒè¯
- [ ] è¿è¡Œ `go build ./...`
- [ ] è¿è¡Œ `go test ./...`
- [ ] æµ‹è¯•ç« èŠ‚æ’åºåŠŸèƒ½
- [ ] éªŒè¯å»é‡æœåŠ¡

## 2. æ–‡æ¡£æ›´æ–°
- [ ] æ›´æ–° `FOLDER_STRUCTURE.md`
- [ ] æ›´æ–° `pkg/utils/README.md`
- [ ] æ·»åŠ LexoRankç®—æ³•è¯´æ˜
```

---

## å…­ã€æœ€ç»ˆå»ºè®®

### æ¨èæ–¹æ¡ˆï¼š**æ–¹æ¡ˆC - æ¸è¿›å¼æ•´ç†** â­

**ç†ç”±ï¼š**
1. âœ… **é£é™©å¯æ§**ï¼šåˆ†é˜¶æ®µæ‰§è¡Œï¼Œæ¯é˜¶æ®µéƒ½å¯ç‹¬ç«‹éªŒè¯
2. âœ… **å½±å“æœ€å°**ï¼šä¼˜å…ˆå¤„ç†æ— å¼•ç”¨çš„ç›®å½•
3. âœ… **çµæ´»è°ƒæ•´**ï¼šæ¯é˜¶æ®µå®Œæˆåå¯è¯„ä¼°æ˜¯å¦ç»§ç»­
4. âœ… **æ–‡æ¡£å…ˆè¡Œ**ï¼šå…ˆå®Œå–„æ–‡æ¡£ï¼Œå‡å°‘å›¢é˜Ÿå›°æƒ‘

### ä¼˜å…ˆçº§æ’åº

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | é£é™©ç­‰çº§ | å»ºè®® |
|--------|------|----------|----------|------|
| **P0** | åˆ é™¤ `pkg/config/` | 0.5å¤© | ğŸŸ¢ ä½ | ç«‹å³æ‰§è¡Œ |
| **P0** | å½’æ¡£ `repository/mongodb/migration/` | 0.5å¤© | ğŸŸ¢ ä½ | ç«‹å³æ‰§è¡Œ |
| **P0** | ç§»åŠ¨ `migrations/` åˆ° `migration/examples/` | 0.5å¤© | ğŸŸ¢ ä½ | ç«‹å³æ‰§è¡Œ |
| **P0** | æ·»åŠ ç›®å½•ç»“æ„æ–‡æ¡£ | 1å¤© | ğŸŸ¢ ä½ | ç«‹å³æ‰§è¡Œ |
| **P1** | é‡å‘½å `configs/` ä¸º `config/resources/` | 2å¤© | ğŸŸ¡ ä¸­ | è¿‘æœŸæ‰§è¡Œ |
| **P2** | æ•´åˆ `utils/` åˆ° `pkg/utils/` | 1å¤© | ğŸŸ¢ ä½ | é•¿æœŸè€ƒè™‘ |

### æ‰§è¡Œæ£€æŸ¥ç‚¹

**æ¯ä¸ªé˜¶æ®µå®Œæˆåå¿…é¡»ï¼š**
1. âœ… è¿è¡Œ `go build ./...` ç¡®ä¿ç¼–è¯‘é€šè¿‡
2. âœ… è¿è¡Œ `go test ./...` ç¡®ä¿æµ‹è¯•é€šè¿‡
3. âœ… å¯åŠ¨æœåŠ¡éªŒè¯æ ¸å¿ƒåŠŸèƒ½
4. âœ… æ›´æ–°ç›¸å…³æ–‡æ¡£
5. âœ… Code Review

### é¢„æœŸæ”¶ç›Š

**ç¬¬ä¸€é˜¶æ®µå®Œæˆåï¼š**
- æ¸…ç†3ä¸ªæœªä½¿ç”¨çš„ç›®å½•/æ–‡ä»¶
- å‡å°‘~500è¡Œå†—ä½™ä»£ç 
- æ–‡æ¡£åŒ–ç›®å½•ç»“æ„ï¼Œå‡å°‘å›¢é˜Ÿå›°æƒ‘

**ç¬¬äºŒé˜¶æ®µå®Œæˆåï¼š**
- é…ç½®æ–‡ä»¶ç»„ç»‡æ›´æ¸…æ™°
- `config/` æˆä¸ºå”¯ä¸€é…ç½®ç›®å½•
- å‡å°‘è·¯å¾„æ··æ·†

**ç¬¬ä¸‰é˜¶æ®µå®Œæˆåï¼š**
- ç»Ÿä¸€å·¥å…·å‡½æ•°ç®¡ç†
- ç¬¦åˆGoé¡¹ç›®è§„èŒƒ
- ä¾¿äºç»´æŠ¤å’Œæ‰©å±•

---

## ğŸ“š é™„å½•

### é™„å½•Aï¼šæœç´¢å‘½ä»¤æ¸…å•

```bash
# æœç´¢configå¼•ç”¨
grep -r "Qingyu_backend/config" --include="*.go" .

# æœç´¢migrationå¼•ç”¨
grep -r "Qingyu_backend/migration" --include="*.go" .

# æœç´¢utilså¼•ç”¨
grep -r "Qingyu_backend/utils" --include="*.go" .

# æœç´¢configsç¡¬ç¼–ç è·¯å¾„
grep -r "configs/" --include="*.go" --include="*.yaml" .

# ç»Ÿè®¡ä»£ç è¡Œæ•°
find migration/ -name "*.go" | xargs wc -l
find config/ -name "*.go" | xargs wc -l
```

### é™„å½•Bï¼šGitå·¥ä½œæµå»ºè®®

```bash
# ä¸ºæ¯ä¸ªé˜¶æ®µåˆ›å»ºç‹¬ç«‹åˆ†æ”¯
git checkout -b refactor/cleanup-phase1-unused-dirs
git checkout -b refactor/cleanup-phase2-config-structure
git checkout -b refactor/cleanup-phase3-utils-integration

# æäº¤è§„èŒƒ
git commit -m "refactor(folder): åˆ é™¤æœªä½¿ç”¨çš„pkg/configç›®å½•

- åˆ é™¤pkg/config/ï¼ˆ0æ¬¡å¼•ç”¨ï¼‰
- æ·»åŠ ç›®å½•ç»“æ„æ–‡æ¡£
- æ›´æ–°READMEè¯´æ˜

Co-Authored-By: çŒ«å¨˜Kore"
```

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**åˆ›å»ºæ—¥æœŸï¼š** 2026-01-30
**ä½œè€…ï¼š** çŒ«å¨˜Kore
**ç»´æŠ¤è€…ï¼š** yukin371
