{
  "analysis_date": "2026-01-29",
  "module": "writer",
  "total_files": 17,
  "total_shared_calls": 138,
  "total_response_calls": 257,
  "migration_progress": "65%",
  "estimated_remaining_hours": 12.5,
  "files": [
    {
      "name": "audit_api.go",
      "function": "审核API",
      "shared_calls": 0,
      "response_calls": 33,
      "total_calls": 33,
      "migration_status": "completed",
      "complexity": "low",
      "risk_level": "low",
      "estimated_minutes": 0,
      "priority": "P0",
      "special_scenarios": [],
      "test_coverage": "good"
    },
    {
      "name": "batch_operation_api.go",
      "function": "批量操作API",
      "shared_calls": 0,
      "response_calls": 0,
      "total_calls": 0,
      "migration_status": "not_started",
      "complexity": "high",
      "risk_level": "high",
      "estimated_minutes": 120,
      "priority": "P0",
      "special_scenarios": ["async_execution", "batch_operations", "conflict_policy"],
      "test_coverage": "none",
      "notes": "完全未使用响应包，需要完整重构"
    },
    {
      "name": "character_api.go",
      "function": "角色管理API",
      "shared_calls": 10,
      "response_calls": 20,
      "total_calls": 30,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "comment_api.go",
      "function": "评论管理API",
      "shared_calls": 20,
      "response_calls": 31,
      "total_calls": 51,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 45,
      "priority": "P1",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "document_api.go",
      "function": "文档管理核心API",
      "shared_calls": 11,
      "response_calls": 17,
      "total_calls": 28,
      "migration_status": "partial",
      "complexity": "high",
      "risk_level": "medium",
      "estimated_minutes": 45,
      "priority": "P0",
      "special_scenarios": ["version_control", "document_crud"],
      "test_coverage": "partial"
    },
    {
      "name": "editor_api.go",
      "function": "编辑器核心API",
      "shared_calls": 14,
      "response_calls": 12,
      "total_calls": 26,
      "migration_status": "partial",
      "complexity": "high",
      "risk_level": "high",
      "estimated_minutes": 60,
      "priority": "P0",
      "special_scenarios": ["realtime_editing", "version_conflict"],
      "test_coverage": "partial",
      "notes": "版本冲突检测需要特殊处理"
    },
    {
      "name": "export_api.go",
      "function": "导出API",
      "shared_calls": 7,
      "response_calls": 15,
      "total_calls": 22,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P2",
      "special_scenarios": ["file_download"],
      "test_coverage": "partial"
    },
    {
      "name": "location_api.go",
      "function": "位置API",
      "shared_calls": 10,
      "response_calls": 20,
      "total_calls": 30,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "lock_api.go",
      "function": "分布式锁API",
      "shared_calls": 13,
      "response_calls": 14,
      "total_calls": 27,
      "migration_status": "partial",
      "complexity": "high",
      "risk_level": "high",
      "estimated_minutes": 60,
      "priority": "P1",
      "special_scenarios": ["distributed_lock", "concurrency_control"],
      "test_coverage": "partial",
      "notes": "并发控制逻辑复杂"
    },
    {
      "name": "project_api.go",
      "function": "项目管理API",
      "shared_calls": 6,
      "response_calls": 8,
      "total_calls": 14,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P0",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "publish_api.go",
      "function": "发布API",
      "shared_calls": 8,
      "response_calls": 19,
      "total_calls": 27,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 25,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "search_api.go",
      "function": "搜索API",
      "shared_calls": 1,
      "response_calls": 2,
      "total_calls": 3,
      "migration_status": "partial",
      "complexity": "low",
      "risk_level": "low",
      "estimated_minutes": 10,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "stats_api.go",
      "function": "统计API",
      "shared_calls": 11,
      "response_calls": 22,
      "total_calls": 33,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "template_api.go",
      "function": "模板API",
      "shared_calls": 11,
      "response_calls": 18,
      "total_calls": 29,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P2",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "timeline_api.go",
      "function": "时间线API",
      "shared_calls": 12,
      "response_calls": 21,
      "total_calls": 33,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "medium",
      "estimated_minutes": 30,
      "priority": "P1",
      "special_scenarios": [],
      "test_coverage": "partial"
    },
    {
      "name": "version_api.go",
      "function": "版本管理API",
      "shared_calls": 4,
      "response_calls": 5,
      "total_calls": 9,
      "migration_status": "partial",
      "complexity": "medium",
      "risk_level": "low",
      "estimated_minutes": 20,
      "priority": "P1",
      "special_scenarios": [],
      "test_coverage": "partial"
    }
  ],
  "migration_batches": [
    {
      "batch": 1,
      "name": "简单API（建立信心）",
      "files": ["audit_api.go", "search_api.go", "version_api.go", "project_api.go", "publish_api.go"],
      "shared_calls": 19,
      "estimated_hours": 1.5,
      "description": "从最简单的API开始，建立迁移信心和流程"
    },
    {
      "batch": 2,
      "name": "中等复杂度",
      "files": ["export_api.go", "character_api.go", "location_api.go", "template_api.go", "stats_api.go", "document_api.go"],
      "shared_calls": 60,
      "estimated_hours": 3,
      "description": "处理中等复杂度的API，包含核心文档功能"
    },
    {
      "batch": 3,
      "name": "复杂功能",
      "files": ["timeline_api.go", "comment_api.go", "lock_api.go", "editor_api.go"],
      "shared_calls": 59,
      "estimated_hours": 2.5,
      "description": "处理复杂的分布式锁、实时编辑等功能"
    },
    {
      "batch": 4,
      "name": "完全重构",
      "files": ["batch_operation_api.go"],
      "shared_calls": 0,
      "estimated_hours": 2,
      "description": "完全重构批量操作API"
    }
  ],
  "risk_assessment": {
    "high_risk_files": ["batch_operation_api.go", "editor_api.go", "lock_api.go"],
    "medium_risk_files": ["document_api.go", "comment_api.go", "export_api.go"],
    "low_risk_files": ["audit_api.go", "search_api.go", "version_api.go"],
    "special_concerns": [
      "实时编辑场景的版本冲突处理",
      "分布式锁的并发控制",
      "批量操作的完整重构",
      "文件下载的特殊处理"
    ]
  },
  "recommendations": [
    "按批次逐步迁移，从简单到复杂",
    "优先处理batch_operation_api.go的完整重构",
    "为editor_api.go的版本冲突制定专项方案",
    "保留WebSocket相关的net/http导入",
    "每个文件迁移后立即测试验证",
    "及时更新Swagger注释"
  ]
}
